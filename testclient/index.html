<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ytdl test client</title>
</head>
<body>
  <p>hiiii</p>
  <button id="btn">do the thing</button>

  <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
  <script>
    ////////////////////////////////////////////
    $('#btn').click(function() {
      init(['a','b','d','c','z','j','h','xx']);
    });

    function doTheThing(str) {
      $.ajax({
        type: 'POST',
        url: '/api/endpoint',
        data: str,
        success: function(response) {
          console.log(response);
        }
      })
    }

    function init(arrtemp) {
      // var arr = arrtemp;
      // var queue = [arr.unshift(), arr.unshift()];
      // var tempindex = queue.length;

      // while (queue.length > 0 && queue.length < 3) {
      //   if (arr.length) {
      //     $.ajax({
      //       type: 'POST',
      //       url: '/api/endpoint',
      //       data: arr.unshift(),
      //       success: function(response) {
      //         console.log(response);
      //         queue.unshift(tempindex);
      //       }
      //     });
      //   }
      // }
      var arr = arrtemp;
      
      // var myInterval = setInterval(function() {
      //   if (arr.length) {
      //     $.ajax({
      //       type: 'POST',
      //       url: '/api/endpoint',
      //       data: {keyx: arr.shift()},
      //       success: function(response) {
      //         console.log(response);
      //       }
      //     });
      //   } else {
      //     clearInterval(myInterval);
      //   }
      // }, 300);
      for (var i = 0; i < arr.length; i++) {
        $.ajax({
          type: 'POST',
          url: '/api/endpoint',
          data: {keyx: arr[i]},
          async: false,
          success: function(response) {
            console.log(response.ltr, response.time);
          }
        });
      }
    }
    ////////////////////////////////////////////
  </script>
</body>
</html>